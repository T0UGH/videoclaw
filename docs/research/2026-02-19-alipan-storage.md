# 阿里云盘存储接入调研

## 调研时间
2026-02-19

## 背景
 Videoclaw 项目需要支持将生成的视频/图片上传到云端，方便用户分享和查看。

## 当前代码库状态

### 现有存储实现
```
videoclaw/storage/
├── base.py      # StorageBackend 基类定义
└── local.py     # 本地存储唯一实现
```

### 设计文档中的描述
- 文档提到的是**阿里云 OSS** (对象存储)，不是阿里云盘
- OSS 是企业级对象存储服务，API 不同于个人云盘

## 阿里云盘 (Alipan) API 分析

### 认证方式
- 需要 OAuth 2.0 授权码模式
- 需要用户登录获取 access_token 和 refresh_token
- token 有有效期限制

### 主要 API
1. **文件上传**
   - 需要先获取上传链接
   - 分片上传大文件
   - 限制文件大小

2. **文件下载**
   - 获取文件下载链接
   - 链接有时效性

3. **分享功能**
   - 创建分享链接
   - 设置分享密码（可选）

### Python SDK
社区有非官方的 SDK，但：
- 非阿里官方维护
- 可能存在兼容性问题
- 需要自行测试

## 对比：阿里云 OSS vs 阿里云盘

| 特性 | 阿里云 OSS | 阿里云盘 |
|------|-----------|----------|
| 定位 | 企业级对象存储 | 个人云盘 |
| 认证 | AK/SK 签名 | OAuth 2.0 |
| 用途 | 存储服务 | 分享/备份 |
| 费用 | 按量付费/包年 | 免费额度 |

## 结论与建议

### 推荐方案
1. **优先实现阿里云 OSS** - 与火山引擎同体系，SDK 成熟
2. **阿里云盘作为可选** - 需要额外处理 OAuth 流程

### 待实现
- [ ] 阿里云 OSS 存储后端 (videoclaw/storage/oss.py)
- [ ] 阿里云盘存储后端 (videoclaw/storage/alipan.py) - 可选

### 参考文档
- 阿里云 OSS: https://help.aliyun.com/document_detail/111.html
- 阿里云盘开放平台: https://open.alipan.com/
